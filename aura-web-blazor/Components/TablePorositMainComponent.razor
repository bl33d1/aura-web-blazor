@using Data.Models
@inject NavigationManager UriHelper
<MudText Align="Align.Center" Style="margin-bottom:15px;margin-top:30px; font-size:16px; font-weight:bold;">Faturat e fundit</MudText>

<MudTable Striped=true Dense=true Style="font-size:small" Items="@GetFaturat(@TakeAll)" Breakpoint="Breakpoint.None" FixedHeader=true FixedFooter=true>
    <HeaderContent>
        <MudTh>Produkti</MudTh>
        <MudTh>Sasia</MudTh>
        <MudTh>Vlera</MudTh>
        <MudTh>Tavolina</MudTh>
        <MudTh>Kamarieri</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd >@context.artikulli</MudTd>
        <MudTd >@context.sasia</MudTd>
        <MudTd >@decimal.Parse(context.vlera).ToString("0.00")</MudTd>
        <MudTd >@context.tav <br /> @DateTime.Parse(context.ora).ToString("HH:mm:ss")</MudTd>
        <MudTd >@context.kam</MudTd>
    </RowTemplate>
    <FooterContent>
    </FooterContent>
</MudTable>


@*<MudSimpleTable Striped=true Hover=true >
    <thead class="table-header">
        <tr>
            <td style="font-weight: bolder; font-size: small;" class="table-header-left table-header-font">Produkti</td>
            <td style="font-weight: bolder; font-size: small;" class="table-header-font">Sasia</td>
            <td style="font-weight: bolder; font-size: small;" class="table-header-font">Vlera</td>
            <td style="font-weight: bolder; font-size: small;" class="text-center table-header-font">Tav</td>
            <td style="font-weight: bolder; font-size: small;" class="table-header-right ">Kam</td>
        </tr>
    </thead>
   @foreach (var x in GetFaturat(@TakeAll)){
    <tr style="font-size: small; padding-bottom:10px;">
        <td style="font-size: 12px;padding-left:6px;">@x.artikulli</td>
        <td style="font-size: 12px; text-align:center;">@x.sasia</td>
        <td style="font-size: 12px; text-align:center;">@decimal.Parse(x.vlera).ToString("0.00")</td>
        <td class="text-center" style="font-size: 10px; text-align:center; padding-top:5px;">@x.tav
            <br />
            @DateTime.Parse(x.ora).ToString("HH:mm:ss")</td>
        <td style="font-size: 11px;text-align:right; padding-right:6px;">@x.kam</td>
    </tr>
    }

     <tfoot>
        <tr>
            <td class="table-footer-bot table-header-font" colspan="5" style="text-align: center"><a class="tdBtn" @onclick=Navigate>@(TakeAll ? "Kthehu" : "Shiko te gjitha")</a></td>
        </tr>
    </tfoot>
</MudSimpleTable>*@

@code {
    bool fixed_header = true;
    bool fixed_footer = true;

    private IEnumerable<DetaletEFaturimit>? Orders;

    [Parameter]
    public bool TakeAll { get; set; }

    protected override async Task OnInitializedAsync()
    {
        Orders = await new Data.GetData().GetDetaletAsync();
    }
    void Navigate()
    {
        if(!TakeAll)
        UriHelper.NavigateTo("faturat");
        else
        UriHelper.NavigateTo("/");

    }

    protected IEnumerable<DetaletEFaturimit> GetFaturat(bool TakeAll)
    {
        if (TakeAll)
            return Orders.OrderByDescending(d => DateTime.Parse(d.ora));
        else
            return Orders.OrderByDescending(d => DateTime.Parse(d.ora)).Take(15);
    }
}
