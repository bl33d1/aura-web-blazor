@using Data.Models
@using Services
@inject IOrderService orderService

<style>
    .mud-expand-panel-content {
        padding: 0 5px 16px !important;
    }
</style>
<MudExpansionPanels Class="rounded-lg" Elevation="2" Style="padding:0px; ">
    <MudExpansionPanel @bind-IsExpanded="isOpen" Class="rounded-lg" HideIcon="true">

        <TitleContent>
            <div class="d-flex align-content-between" style="justify-content: space-between;">
                <MudText Class="mt-1" Style="font-weight:bold; font-size:20px;">Totali</MudText>
                <MudText Align="Align.Right" Style="font-weight:bold; font-size:21px;">@Orders.Sum(d => decimal.Parse(d.Vlera)).ToString(".00")€</MudText>
            </div>
            <div class="d-flex align-content-center" style="justify-content: center;">

                <MudIcon Icon="@(isOpen ? @Icons.Filled.ExpandLess : @Icons.Filled.ExpandMore)" Style="max-width:70px;" Title="Zgjero"></MudIcon>
            </div>
        </TitleContent>


        <ChildContent>
            <TabMainComponent />
        </ChildContent>

    </MudExpansionPanel>
</MudExpansionPanels>

@code {
    bool isOpen;
    private IEnumerable<DetaletEFaturimit>? Orders;
    protected override async Task OnInitializedAsync()
    {
        await GetOrders();
    }

    private async Task GetOrders()
    {
        Orders = await orderService.GetOrders();
    }
}
